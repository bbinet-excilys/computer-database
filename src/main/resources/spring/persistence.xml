<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:context="http://www.springframework.org/schema/context" xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc.xsd">
  <!-- Hikari -->
  <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
      <list>
        <value>classpath:/properties/hikari.properties</value>
      </list>
    </property>
  </bean>
  <bean id="dataSource" class="org.apache.tomcat.dbcp.dbcp2.BasicDataSource">
    <property name="driverClassName" value="${dataSource.driverClassName}" />
    <property name="url" value="${dataSource.url}" />
    <property name="username" value="${dataSource.user}" />
    <property name="password" value="${dataSource.password}" />
  </bean>
  <bean id="JDBCTemplate" class="org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate">
    <constructor-arg ref="dataSource" />
  </bean>
  <bean id="transactionManager" class="org.springframework.orm.hibernate5.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
  </bean>
  <!-- Hibernate -->
  <bean id="sessionFactory" class="org.springframework.orm.hibernate5.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="packagesToScan" value="model" />
    <property name="hibernateProperties">
      <props>
        <prop key="hibernate.hbm2ddl.auto">${hibernate.hbm2ddl.auto}</prop>
        <prop key="hibernate.dialect">${hibernate.dialect}</prop>
        <prop key="show_sql">true</prop>
        <prop key="format_sql">true</prop>
      </props>
    </property>
    <property name="mappingResources">
      <list>
        <value>mapping/Computer.hbm.xml</value>
        <value>mapping/Company.hbm.xml</value>
      </list>
    </property>
  </bean>
  <bean id="persistenceExceptionTranslationPostProcessor" class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor" />
  <!-- DAOs -->
  <bean id="ComputerDAO" class="persistence.ComputerDAO">
    <property name="jdbcTemplate" ref="JDBCTemplate" />
    <property name="computerMapper" ref="ComputerMapper" />
    <property name="queryFactory" ref="queryFactory" />
    <property name="sessionFactory" ref="sessionFactory" />
  </bean>
  <bean id="CompanyDAO" class="persistence.CompanyDAO">
    <property name="jdbcTemplate" ref="JDBCTemplate" />
    <property name="companyMapper" ref="CompanyMapper" />
  </bean>
  <bean id="queryFactory" class="com.querydsl.jpa.impl.JPAQueryFactory">
    <constructor-arg>
      <bean factory-bean="sessionFactory" factory-method="createEntityManager"></bean>
    </constructor-arg>
  </bean>
</beans>